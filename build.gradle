apply plugin: 'groovy'

repositories {
    mavenCentral()
    maven { url "http://groovypp.artifactoryonline.com/groovypp/libs-releases-local" }
}

sourceSets {
    perfTest {
        groovy.srcDirs = ['src/perf/groovy']
    }
}

dependencies {
    groovy 'org.codehaus.groovy:groovy:1.8.6'

    testCompile('org.spockframework:spock-core:0.6-groovy-1.8') {
        exclude module: 'groovy-all'
    }

    perfTestCompile 'com.googlecode.gbench:gbench:0.3.0-groovy-1.8'
    perfTestCompile 'com.samskivert:jmustache:1.5'
    perfTestCompile 'org.mozilla:rhino:1.7R3'

    perfTestCompile sourceSets.main.output
    perfTestCompile configurations.testCompile
    perfTestCompile sourceSets.test.output
    perfTestRuntime configurations.testRuntime
}

task wrapper(type: Wrapper) {
    gradleVersion = '0.9'
}

task performanceTest(type: JavaExec, dependsOn: classes) {
    classpath sourceSets.perfTest.runtimeClasspath
    main = 'Simple'
    jvmArgs = ['-server']
}
